<style>
header{
  position: fixed;
  top: 0;
  left: 0;
  width: calc(100vw - 20px);
  height: 20px;
  padding: 10px;
  display: flex;
  background: linear-gradient(to right, #F486BA, #FFCE5D);
  color: black;
  font-size: 18px;
  z-index: 9;
}

body{
  padding: 50px 10px 10px 10px; /* bodyの内側余白を指定する(上:右:下:左) */
}

.tile{
  vertical-align: middle;
}

.delimiter{
  margin-left: 4px;
  margin-right: 4px;
}
</style>

<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="asset/modaal.js"></script>
  <link href="asset/modaal.css" rel="stylesheet" type="text/css">
</head>


<body>

<header>
  <a href=./index.html>home</a>
  <div class='delimiter'>/</div>
  <a id='folder' href='_'>folder</a>

  <div style="margin-right: 20px; margin-left: auto;">
    <input type="range" id="cols" min="1" max="7" step="1">
  </div>
</header>

<center><span id='media'></span></center>


<script src="index.js"></script>
<script>
const contentId = location.search.split("?")[1];
const dir = `../contents/${contentId}`

document.getElementById('folder').setAttribute('href', dir);

const media = document.getElementById('media');
function draw(r){
  media.innerHTML = table[contentId].map(function(e){
    const src = `${dir}/${e}`;
    const ext = src.slice(src.lastIndexOf('.'));
    const size = (window.innerWidth-100)/r;

    if([".jpeg", ".png"].indexOf(ext) > -1){
      return `<a class="image tile" data-group="gallery" href=${src}>`
        + `<img src="${src}" width=${size}></img>`
        + `</a>`;
    }
    else if([".mp4"].indexOf(ext) > -1){
      return `<a class="iframe tile" href=${src}>`
        + `<video autoplay muted loop src="${src}" width=${size}></video>`
        + `</a>`;
    }
    else if([".mov"].indexOf(ext) > -1){
      return `<video controls autoplay muted loop src="${src}" class="tile" width=${size}></video>`;
    }
  }).join('');

  $('.image').modaal({
    type: 'image',
    hide_close: true,
  })
  $('.iframe').modaal({
    type: 'iframe',
    hide_close: true,
  });
}

window.onload = ()=>{
  const cols = document.getElementById('cols');
  cols.value = Math.sqrt(table[contentId].length) * (window.innerWidth/window.innerHeight);
  cols.addEventListener('input', (e)=>{draw(e.target.value);});
  draw(cols.value);
}
</script>

</body>